<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seed Jobs Database</title>
    <script src="https://unpkg.com/dexie@3.2.1/dist/dexie.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            line-height: 1.6;
        }
        .container {
            border: 1px solid #ddd;
            padding: 20px;
            border-radius: 8px;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #0056b3;
        }
        button:disabled {
            background: #6c757d;
            cursor: not-allowed;
        }
        .status {
            margin: 10px 0;
            padding: 10px;
            border-radius: 4px;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
        .progress { background: #fff3cd; color: #856404; }
        .job-list {
            margin-top: 20px;
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid #ddd;
            padding: 10px;
            border-radius: 4px;
        }
        .job-item {
            padding: 8px;
            border-bottom: 1px solid #eee;
        }
        .job-item:last-child {
            border-bottom: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Seed Jobs Database</h1>
        <p>This will add 25 realistic job positions to your database.</p>
        
        <button onclick="seedJobs()">Seed 25 Jobs</button>
        <button onclick="clearJobs()" style="background: #dc3545;">Clear All Jobs</button>
        <button onclick="checkJobs()">Check Jobs Count</button>
        <button onclick="listJobs()">List All Jobs</button>
        
        <div id="status"></div>
        <div id="progress"></div>
        <div id="jobList" class="job-list"></div>
    </div>

    <script>
        // Initialize Dexie database
        const db = new Dexie('jobPortal');
        db.version(2).stores({
            jobs: '++id, title, slug, status, order, createdAt',
            candidates: '++id, firstName, lastName, email, jobId, stage, createdAt, [jobId+stage]'
        });

        // Simple UUID generator
        function generateUUID() {
            return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
                const r = Math.random() * 16 | 0;
                const v = c == 'x' ? r : (r & 0x3 | 0x8);
                return v.toString(16);
            });
        }

        // Generate a unique slug from title
        function generateSlug(title) {
            return title
                .toLowerCase()
                .replace(/[^\w\s-]/g, '')
                .replace(/[\s_-]+/g, '-')
                .replace(/^-+|-+$/g, '');
        }

        // Generate random tags based on job type
        function generateTags(title) {
            const tags = [];
            
            if (title.toLowerCase().includes('frontend')) {
                tags.push('React', 'JavaScript', 'TypeScript', 'CSS', 'HTML');
            } else if (title.toLowerCase().includes('backend')) {
                tags.push('Node.js', 'Python', 'Java', 'API', 'Database');
            } else if (title.toLowerCase().includes('full stack')) {
                tags.push('React', 'Node.js', 'MongoDB', 'TypeScript', 'AWS');
            } else if (title.toLowerCase().includes('devops')) {
                tags.push('AWS', 'Docker', 'Kubernetes', 'CI/CD', 'Linux');
            } else if (title.toLowerCase().includes('mobile')) {
                tags.push('React Native', 'iOS', 'Android', 'TypeScript');
            } else if (title.toLowerCase().includes('data')) {
                tags.push('Python', 'SQL', 'Machine Learning', 'Analysis');
            } else if (title.toLowerCase().includes('ux')) {
                tags.push('Figma', 'UI/UX', 'Prototyping', 'Research');
            } else if (title.toLowerCase().includes('product')) {
                tags.push('Strategy', 'Roadmap', 'User Research', 'Agile');
            } else if (title.toLowerCase().includes('qa')) {
                tags.push('Testing', 'Automation', 'Selenium', 'Quality');
            } else {
                tags.push('Technology', 'Software', 'Development');
            }
            
            // Add some random additional tags
            const allTags = ['Remote', 'Flexible', 'Senior', 'Junior', 'Team Lead', 'Agile', 'Scrum'];
            const randomTag = allTags[Math.floor(Math.random() * allTags.length)];
            if (!tags.includes(randomTag)) {
                tags.push(randomTag);
            }
            
            return tags.slice(0, 4); // Return max 4 tags
        }

        // Sample job data - 25 realistic jobs
        const sampleJobs = [
            {
                title: "Senior Frontend Developer",
                description: "We are looking for an experienced Frontend Developer to join our team. You will be responsible for building responsive web applications using modern JavaScript frameworks.",
                department: "Engineering",
                location: "San Francisco, CA"
            },
            {
                title: "Backend Engineer - Node.js",
                description: "Join our backend team to build scalable APIs and services. Experience with microservices architecture and cloud platforms is required.",
                department: "Engineering",
                location: "Remote"
            },
            {
                title: "Full Stack Developer",
                description: "Looking for a Full Stack Developer proficient in both frontend and backend technologies. You'll work on end-to-end feature development.",
                department: "Engineering",
                location: "New York, NY"
            },
            {
                title: "DevOps Engineer",
                description: "Join our infrastructure team to build and maintain our cloud infrastructure. Experience with containerization and CI/CD pipelines required.",
                department: "Engineering",
                location: "Austin, TX"
            },
            {
                title: "Data Scientist",
                description: "We're seeking a Data Scientist to analyze complex datasets and build machine learning models to drive business decisions.",
                department: "Data Science",
                location: "Boston, MA"
            },
            {
                title: "UX/UI Designer",
                description: "Create beautiful and intuitive user interfaces for our products. Strong portfolio and experience with design tools required.",
                department: "Design",
                location: "Remote"
            },
            {
                title: "Product Manager",
                description: "Lead product development from conception to launch. Work with engineering, design, and business teams to deliver great products.",
                department: "Product",
                location: "Seattle, WA"
            },
            {
                title: "Mobile Developer - React Native",
                description: "Build cross-platform mobile applications using React Native. Experience with native iOS/Android development is a plus.",
                department: "Engineering",
                location: "Chicago, IL"
            },
            {
                title: "QA Automation Engineer",
                description: "Develop and maintain automated test suites for our web and mobile applications. Experience with testing frameworks required.",
                department: "Engineering",
                location: "Remote"
            },
            {
                title: "Technical Lead",
                description: "Lead a team of developers and drive technical excellence. Strong architecture and leadership skills required.",
                department: "Engineering",
                location: "San Francisco, CA"
            },
            {
                title: "Cloud Architect",
                description: "Design and implement cloud infrastructure solutions. AWS/Azure certifications and architecture experience required.",
                department: "Engineering",
                location: "Remote"
            },
            {
                title: "Machine Learning Engineer",
                description: "Build and deploy machine learning models at scale. Experience with TensorFlow/PyTorch and MLOps practices required.",
                department: "Data Science",
                location: "New York, NY"
            },
            {
                title: "Frontend Engineer - React",
                description: "Build modern web applications using React. Experience with state management and modern build tools required.",
                department: "Engineering",
                location: "Los Angeles, CA"
            },
            {
                title: "Backend Developer - Python",
                description: "Develop robust backend services using Python and Django/Flask. Experience with database design and API development.",
                department: "Engineering",
                location: "Remote"
            },
            {
                title: "Site Reliability Engineer",
                description: "Ensure the reliability and performance of our production systems. Experience with monitoring and incident response required.",
                department: "Engineering",
                location: "Austin, TX"
            },
            {
                title: "Data Engineer",
                description: "Build and maintain data pipelines and warehouses. Experience with ETL processes and big data technologies required.",
                department: "Data Science",
                location: "Boston, MA"
            },
            {
                title: "UI Developer",
                description: "Bridge the gap between design and engineering. Strong CSS skills and attention to detail required.",
                department: "Engineering",
                location: "Remote"
            },
            {
                title: "Senior Product Designer",
                description: "Lead design for key product areas. Experience with user research and design systems required.",
                department: "Design",
                location: "San Francisco, CA"
            },
            {
                title: "API Developer",
                description: "Design and build RESTful APIs. Experience with API design principles and documentation required.",
                department: "Engineering",
                location: "New York, NY"
            },
            {
                title: "Security Engineer",
                description: "Protect our systems and data from security threats. Experience with security testing and incident response required.",
                department: "Engineering",
                location: "Remote"
            },
            {
                title: "Junior Frontend Developer",
                description: "Great opportunity for a junior developer to grow their skills in a supportive environment. HTML/CSS/JavaScript knowledge required.",
                department: "Engineering",
                location: "Chicago, IL"
            },
            {
                title: "Database Administrator",
                description: "Manage and optimize our database systems. Experience with SQL and database performance tuning required.",
                department: "Engineering",
                location: "Remote"
            },
            {
                title: "Technical Product Manager",
                description: "Work closely with engineering teams on technical products. Strong technical background and product sense required.",
                department: "Product",
                location: "Seattle, WA"
            },
            {
                title: "Software Engineer - Java",
                description: "Build enterprise-grade applications using Java and Spring Boot. Experience with microservices architecture required.",
                department: "Engineering",
                location: "Remote"
            },
            {
                title: "Lead UX Researcher",
                description: "Conduct user research and usability testing to inform product decisions. Experience with research methodologies required.",
                department: "Design",
                location: "San Francisco, CA"
            }
        ];

        async function seedJobs() {
            const statusEl = document.getElementById('status');
            const progressEl = document.getElementById('progress');
            
            try {
                statusEl.innerHTML = '<div class="progress">Starting job generation...</div>';
                
                const jobsToAdd = sampleJobs.map((job, index) => {
                    const slug = generateSlug(job.title);
                    const tags = generateTags(job.title);
                    
                    return {
                        id: generateUUID(),
                        title: job.title,
                        slug: slug,
                        status: 'active',
                        description: job.description,
                        department: job.department,
                        location: job.location,
                        tags: tags,
                        order: index + 1,
                        createdAt: new Date(),
                        updatedAt: new Date(),
                        isArchived: false
                    };
                });

                progressEl.innerHTML = '<div class="info">Adding jobs to database...</div>';
                
                // Clear existing jobs first to avoid duplicates
                await db.jobs.clear();
                
                // Add all jobs
                await db.jobs.bulkAdd(jobsToAdd);
                
                statusEl.innerHTML = `<div class="success">✅ Successfully created ${jobsToAdd.length} jobs!</div>`;
                progressEl.innerHTML = '';
                
            } catch (error) {
                statusEl.innerHTML = `<div class="error">❌ Error: ${error.message}</div>`;
                console.error('Seeding error:', error);
            }
        }

        async function clearJobs() {
            const statusEl = document.getElementById('status');
            try {
                await db.jobs.clear();
                statusEl.innerHTML = `<div class="success">✅ All jobs have been cleared from the database.</div>`;
                document.getElementById('jobList').innerHTML = '';
            } catch (error) {
                statusEl.innerHTML = `<div class="error">❌ Error clearing jobs: ${error.message}</div>`;
            }
        }

        async function checkJobs() {
            const statusEl = document.getElementById('status');
            try {
                const count = await db.jobs.count();
                statusEl.innerHTML = `<div class="info">📊 There are currently ${count} jobs in the database.</div>`;
            } catch (error) {
                statusEl.innerHTML = `<div class="error">❌ Error checking count: ${error.message}</div>`;
            }
        }

        async function listJobs() {
            const jobListEl = document.getElementById('jobList');
            const statusEl = document.getElementById('status');
            
            try {
                const jobs = await db.jobs.toArray();
                
                if (jobs.length === 0) {
                    jobListEl.innerHTML = '<div class="info">No jobs found in database.</div>';
                    return;
                }
                
                let html = '<h3>Current Jobs:</h3>';
                jobs.forEach(job => {
                    html += `
                        <div class="job-item">
                            <strong>${job.title}</strong><br>
                            <small>${job.department} • ${job.location}</small><br>
                            <small>Tags: ${job.tags.join(', ')}</small>
                        </div>
                    `;
                });
                
                jobListEl.innerHTML = html;
                statusEl.innerHTML = `<div class="info">📋 Displaying ${jobs.length} jobs</div>`;
                
            } catch (error) {
                statusEl.innerHTML = `<div class="error">❌ Error listing jobs: ${error.message}</div>`;
            }
        }

        // Initialize by checking current count
        window.addEventListener('load', checkJobs);
    </script>
</body>
</html>